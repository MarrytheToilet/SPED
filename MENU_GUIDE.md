# 统一菜单使用指南

## 🚀 启动菜单

```bash
python menu.py
```

## 📋 功能说明

### 【数据提取】

#### 1. 📊 测试系统配置
- 检查API配置
- 检查目录结构
- 检查已解析论文数量
- 测试API连接

**使用场景**：首次使用或排查问题时

#### 2. 📝 提取单个论文（交互式选择）
- 列出所有已解析的论文
- 交互式选择要提取的论文
- 提取指定论文的数据

**使用场景**：测试提取效果或处理特定论文

#### 3. 🚀 批量提取所有论文
- 自动提取所有未处理的论文
- 生成JSON文件保存到extracted目录
- 显示处理进度

**使用场景**：批量处理大量论文

**⚠️ 注意**：可能需要较长时间，建议先测试单个论文

#### 4. 🧪 测试单条数据提取
- 从论文列表中选择一篇
- 测试提取过程
- 显示详细的提取结果
- **不保存**到文件，仅用于测试

**使用场景**：
- 验证提取质量
- 调试提取逻辑
- 快速查看论文能提取出什么数据

**特点**：
- 可以看到实时处理日志
- 显示每条记录的详情
- 显示非空字段统计

### 【数据库管理】

#### 5. 💾 数据库管理工具（交互式菜单）
- 打开完整的数据库管理菜单
- 包含11个数据库操作功能
- 导入、导出、查询、删除等

**功能列表**：
1. 查看数据库统计
2. 从JSON文件导入数据
3. 批量导入extracted目录的所有JSON
4. 导出CSV（完整数据-展平JSON）
5. 导出CSV（完整数据-保留JSON）
6. 导出CSV（数据摘要）
7. 导出CSV（关键字段）
8. 导出所有格式
9. 查询论文数据
10. 删除论文数据
11. 清空所有数据

**使用场景**：需要详细管理数据库时

#### 6. 📥 快速：批量导入JSON到数据库
- 快捷功能，直接导入extracted目录的所有JSON
- 显示导入进度
- 自动去重

**使用场景**：提取完成后快速导入数据库

#### 7. 📤 快速：导出所有CSV格式
- 快捷功能，一次导出4种CSV格式
- full_data_flat（展平JSON）
- full_data_raw（保留JSON）
- summary（数据摘要）
- key_fields（关键字段）

**使用场景**：需要导出数据供分析时

#### 8. 📊 快速：查看数据库统计
- 快捷功能，快速查看统计信息
- 总记录数
- 不同论文数
- 数据库大小
- 最近更新时间

**使用场景**：快速了解数据库状态

### 【系统工具】

#### 9. 📚 查看使用指南
- 显示快速使用指南
- 列出所有文档位置

**文档列表**：
- README.md - 系统完整介绍
- docs/QUICK_USAGE_GUIDE.md - 快速使用指南
- docs/DATABASE_GUIDE.md - 数据库管理指南
- docs/EXTRACTION_SUCCESS_REPORT.md - 测试报告

#### 10. 📋 查看系统状态
- 检查目录结构
- 统计数据信息
- 检查配置文件
- 显示API配置状态

**包含信息**：
- 目录是否存在
- 已解析论文数
- 已提取JSON数
- 数据库记录数
- 配置文件状态

#### 11. 🔍 查看提取日志
- 列出最近的日志文件
- 显示文件大小和时间
- 提供查看日志的命令示例

**使用场景**：排查问题或查看处理详情

## 🎯 常用工作流程

### 工作流程1：首次使用

```
1. 启动菜单: python menu.py
2. 选择 1 - 测试系统配置
3. 选择 4 - 测试单条数据提取（验证效果）
4. 选择 2 - 提取单个论文（测试完整流程）
5. 选择 10 - 查看系统状态（确认文件生成）
```

### 工作流程2：批量处理

```
1. 选择 3 - 批量提取所有论文
2. 等待提取完成
3. 选择 6 - 批量导入JSON到数据库
4. 选择 7 - 导出所有CSV格式
5. 选择 8 - 查看数据库统计
```

### 工作流程3：数据管理

```
1. 选择 5 - 打开数据库管理工具
2. 在数据库菜单中操作：
   - 导入数据
   - 查询数据
   - 导出CSV
   - 管理数据
```

### 工作流程4：调试问题

```
1. 选择 10 - 查看系统状态（检查配置）
2. 选择 11 - 查看提取日志（查看错误）
3. 选择 4 - 测试单条数据提取（验证功能）
4. 选择 1 - 测试系统配置（检查API）
```

## 💡 使用技巧

### 技巧1：先测试后批量
```
在批量处理前：
1. 用选项4测试单条数据
2. 用选项2提取单个论文
3. 确认质量后再选择3批量提取
```

### 技巧2：快捷导入导出
```
使用快捷功能提高效率：
- 选项6：快速导入（不需要进入数据库菜单）
- 选项7：快速导出（不需要进入数据库菜单）
- 选项8：快速查看统计
```

### 技巧3：监控处理进度
```
使用系统工具了解状态：
- 选项10：查看系统状态（文件数量）
- 选项11：查看日志（处理详情）
- 选项8：查看数据库统计（数据量）
```

### 技巧4：问题排查
```
遇到问题时的检查顺序：
1. 选项10 - 查看系统状态
2. 选项1 - 测试系统配置
3. 选项11 - 查看提取日志
4. 选项4 - 测试单条数据
```

## 🔄 与其他工具的关系

### menu.py vs extract.py
- `menu.py`：统一入口，图形化菜单
- `extract.py`：命令行工具，直接执行

**关系**：menu.py调用extract.py

### menu.py vs database.py
- `menu.py`：包含快捷数据库功能
- `database.py`：完整的数据库管理菜单

**关系**：menu.py的选项5会打开database.py

### 选择使用哪个？

**使用menu.py当**：
- 需要图形化界面
- 不熟悉命令行参数
- 需要多功能快速切换

**使用extract.py当**：
- 熟悉命令行
- 需要脚本自动化
- 只需提取功能

**使用database.py当**：
- 需要详细的数据库操作
- 需要高级功能（如删除、清空）

## 📝 快捷键

- `Ctrl+C`: 退出当前操作，返回菜单
- 输入 `0`: 退出程序

## ⚠️ 注意事项

1. **批量处理时间**
   - 批量提取可能需要很长时间
   - 建议先测试单个论文
   - 可以随时Ctrl+C中断

2. **数据库操作**
   - 导入会自动去重
   - 相同dataid的记录会被更新
   - 清空操作需要双重确认

3. **日志文件**
   - 日志会自动保存在logs目录
   - 可以用tail -f查看实时日志
   - 日志文件可能很大

4. **配置文件**
   - .env文件需要正确配置
   - API密钥必须有效
   - 模型建议使用gpt-4o

## 🎉 快速参考

```bash
# 启动菜单
python menu.py

# 常用选项
1  - 测试配置
4  - 测试单条数据（⭐推荐先用这个）
2  - 提取单个论文
3  - 批量提取
6  - 导入数据库
7  - 导出CSV
10 - 查看状态
```

## 📞 需要帮助？

- 菜单内选择 9 查看使用指南
- 查看 README.md 了解系统
- 查看 docs/QUICK_USAGE_GUIDE.md 快速上手
- 查看 docs/DATABASE_GUIDE.md 数据库操作

---

**开始使用**: `python menu.py` 🚀
